<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>AncoreNotes</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600&display=swap"
    rel="stylesheet">
  <!-- plugins:css -->
  <link rel="stylesheet" href="/vendors/mdi/css/materialdesignicons.min.css">
  <link rel="stylesheet" href="/vendors/base/vendor.bundle.base.css">
  <!-- endinject -->
  <!-- plugin css for this page -->
  <link rel="stylesheet" href="/vendors/datatables.net-bs4/dataTables.bootstrap4.css">
  <!-- End plugin css for this page -->
  <!-- inject:css -->
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
    integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
  <link rel="stylesheet" href="/pages_css/category.css">
  <!-- <link rel="stylesheet" href="dashboard.css"> -->
  <!-- endinject -->
  <!-- <link rel="shortcut icon" href="images/favicon.png" /> -->
  <style>
    .profileUrl {
      color: black;
      text-decoration: none;
    }

    .profileUrl:hover {
      color: black;
      text-decoration: none;
    }
  </style>
</head>

<body>
  <div class="container-scroller">
    <!-- partial:partials/_navbar.html -->
    <nav class="navbar col-lg-12 col-12 p-0 fixed-top d-flex flex-row">

      <!-- Name and Logo Section -->
      <%- include('partials/_name_logo'); -%>

        <div class="navbar-menu-wrapper d-flex align-items-center justify-content-end box-shadow-nav">

          <ul class="navbar-nav navbar-nav-right">

            <!--User Profile Section -->
            <%- include('partials/_userProfileSection',{authorProfile: authorProfile}); -%>

          </ul>

          <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button"
            data-toggle="offcanvas">
            <span class="mdi mdi-menu"></span>
          </button>

        </div>

    </nav>



    <!-- partial -->
    <div class="container-fluid page-body-wrapper px-0">

      <!-- SideBar -->
      <!-- partial:partials/_sidebar.html -->
      <%- include('partials/_sidebar'); -%>

        <!-- Main Panel Home  -->
        <!-- partial -->
        <div class="main-panel">
          <div class="content-wrapper pageWrapperP homeBg">

            <!-- Home Top/ Welcome and all -->
            <div class="category__main">
              <div class="card category__top box-shadow-1">

                <%if(year==='1' ){%>
                  <h2>1st Year</h2>

                  <%}else if(year==='2' ){%>
                    <h2>2nd Year</h2>

                    <%}else if(year==='3' ){%>
                      <h2>3rd Year</h2>

                      <%}else if(year==='4' ){%>
                        <h2>4th Year</h2>

                        <%}else if(year === '5'){%>
                          <h2>5th Year</h2>
                          <%}%>


                          <div class="d-flex category__topDetail">
                            <%if(year==='1' ){%>
                              <h5>All Branches</h5>

                              <%}else {%>
                                <h5>
                                  <%=branch_sliced%>
                                </h5>

                                <%}%>

                                  <h5>
                                    <%= college %>
                                  </h5>
                          </div>
              </div>


              <div class="card category__searchFiles box-shadow-2">
                <form action="/dashboard/search/<%= year %>/<%= branch %>" method="POST" class="d-flex">
                  <input type="text" class="form-control" id="exampleFormControlInput1"
                    placeholder="Search for your notes (enter minimum 3 letters to get better results)"
                    name="searchQuery" autocomplete="off" required>
                  <button type="submit" class="btn btn-secondary">Search</button>
                </form>
              </div>

              <div class="card category__allFiles box-shadow-2">

                <% if(pdfs.length==0){ %>
                  <h4 class="text-center">There is no notes or files uploaded here.</h4 class="text-center">



                  <% }else{ %>
                    <% pdfs.forEach((pdf)=>{ %>
                        <% const status = (pdf.upvotes.indexOf(authorProfile._id) != -1) ? "upvoteBtn status" : "upvoteBtn"; %> 
                      <%-include('partials/_pdfFile',{pdf : pdf, branch: branch, year: year, status: status })%>

                        <% }) %>

                          <% } %>
              </div>

            </div>


          </div>
          <!-- content-wrapper ends -->
          <!-- partial:partials/_footer.html -->

          <!-- partial -->
          <!-- <footer class="footer">
            <div class="d-sm-flex justify-content-center justify-content-sm-between">
              <span class="text-muted d-block text-center text-sm-left d-sm-inline-block">Copyright Â© College
                Space</span>
               <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center"> Free <a
                href="https://www.bootstrapdash.com/" target="_blank">Bootstrap dashboard template</a> from
              Bootstrapdash.com</span> 
        </div>
        </footer>
    </div>

    <!-- main-panel ends -->
  </div>
  <!-- page-body-wrapper ends -->
  </div>
  <!-- container-scroller -->




  <!-- plugins:js -->
  <script src="/vendors/base/vendor.bundle.base.js"></script>
  <!-- endinject -->
  <!-- Plugin js for this page-->
  <script src="/vendors/chart.js/Chart.min.js"></script>
  <script src="/vendors/datatables.net/jquery.dataTables.js"></script>
  <script src="/vendors/datatables.net-bs4/dataTables.bootstrap4.js"></script>
  <!-- End plugin js for this page-->
  <!-- inject:js -->
  <script src="/js/off-canvas.js"></script>
  <script src="/js/hoverable-collapse.js"></script>
  <script src="/js/template.js"></script>
  <!-- endinject -->
  <!-- Custom js for this page-->
  <script src="/js/dashboard.js"></script>
  <script src="/js/data-table.js"></script>
  <script src="/js/jquery.dataTables.js"></script>
  <script src="/js/dataTables.bootstrap4.js"></script>
  <!-- End custom js for this page-->
  <script src="/js/jquery.cookie.js" type="text/javascript"></script>

  <!-- Upvote features js -->


  <!-- bootstrap script -->
  <!-- <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"></script> -->
  <!-- <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"></script> -->

  <script>

    function updateUpvote( pdfId ) {
      const year = '<%= year %>'
      const branch = '<%= branch %>'
      $.post('/dashboard/' + year + '/' + branch,
        {
          pdfId: pdfId,
        },
        (res, status) => {
          $(`#${pdfId}`).find('span:nth-child(3)').text(res.upvoteCount);
          if(res.upvoteStatus) {
            $(`#${pdfId}`).addClass("status")
          }
          else {
            $(`#${pdfId}`).removeClass("status")
          }
        });
    }

  </script>
</body>

</html>